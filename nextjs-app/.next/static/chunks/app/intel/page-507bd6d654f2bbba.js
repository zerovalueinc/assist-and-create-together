(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[477],{6619:(e,i,n)=>{Promise.resolve().then(n.bind(n,8900))},8900:(e,i,n)=>{"use strict";n.r(i),n.d(i,{default:()=>P});var t=n(3365),a=n(1521),s=n(8005),r=n(8159),o=n(4130);let c=a.forwardRef((e,i)=>{let{className:n,type:a,...s}=e;return(0,t.jsx)("input",{type:a,className:(0,o.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",n),ref:i,...s})});c.displayName="Input";var l=n(7982);let d=(0,l.A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);var p=n(3678);let u=(0,l.A)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var g=n(6465),y=n(2919),m=n(2866);n(4372);var _=n(1347),h=n(9530);let f=a.forwardRef((e,i)=>{let{className:n,...a}=e;return(0,t.jsx)("div",{className:"relative w-full overflow-auto",children:(0,t.jsx)("table",{ref:i,className:(0,o.cn)("w-full caption-bottom text-sm",n),...a})})});f.displayName="Table";let b=a.forwardRef((e,i)=>{let{className:n,...a}=e;return(0,t.jsx)("thead",{ref:i,className:(0,o.cn)("[&_tr]:border-b",n),...a})});b.displayName="TableHeader";let v=a.forwardRef((e,i)=>{let{className:n,...a}=e;return(0,t.jsx)("tbody",{ref:i,className:(0,o.cn)("[&_tr:last-child]:border-0",n),...a})});v.displayName="TableBody",a.forwardRef((e,i)=>{let{className:n,...a}=e;return(0,t.jsx)("tfoot",{ref:i,className:(0,o.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",n),...a})}).displayName="TableFooter";let x=a.forwardRef((e,i)=>{let{className:n,...a}=e;return(0,t.jsx)("tr",{ref:i,className:(0,o.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",n),...a})});x.displayName="TableRow";let w=a.forwardRef((e,i)=>{let{className:n,...a}=e;return(0,t.jsx)("th",{ref:i,className:(0,o.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",n),...a})});w.displayName="TableHead";let j=a.forwardRef((e,i)=>{let{className:n,...a}=e;return(0,t.jsx)("td",{ref:i,className:(0,o.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",n),...a})});j.displayName="TableCell",a.forwardRef((e,i)=>{let{className:n,...a}=e;return(0,t.jsx)("caption",{ref:i,className:(0,o.cn)("mt-4 text-sm text-muted-foreground",n),...a})}).displayName="TableCaption";let S=[{title:"Company Snapshot",description:"High-level overview of the company for executive context.",fields:{"Company Name":"company_overview.company_name",Website:"company_overview.website",Revenue:"company_overview.revenue","Employee Count (Global)":"company_overview.company_size","Employee Breakdown (By Region)":"company_overview.employees_global","Funding Status":"company_overview.funding_status","Industry Segments":"icp_and_buying.icp_demographics.industry","Overview Summary":"company_overview.overview"}},{title:"Firmographics",description:"Defines the ideal company profile based on structural attributes.",fields:{"Business Model":"icp_and_buying.firmographics.business_model","Sales Channels":"icp_and_buying.firmographics.sales_channels","Decision Making":"icp_and_buying.firmographics.decision_making","Growth Stage":"icp_and_buying.firmographics.growth_stage","Industry (Tags)":"icp_and_buying.icp_demographics.industry","Regions (Target Geography)":"icp_and_buying.icp_demographics.region","Revenue Range":"icp_and_buying.icp_demographics.revenue","Ideal Revenue":"icp_and_buying.icp_demographics.size.employees","Company Size (Employees)":"icp_and_buying.icp_demographics.size.employees","Size Sweet Spot":"icp_and_buying.icp_demographics.size.sweet_spot"}},{title:"Tech Stack & Integration Fit",description:"Common tech tools and platforms this ICP typically uses.",fields:{"Tech Stack Tags":"icp_and_buying.icp_demographics.tech_stack","CRM Platforms":"icp_and_buying.firmographics.business_model","ERP Systems":"icp_and_buying.icp_demographics.industry","Payment Gateways":"icp_and_buying.icp_demographics.revenue","Tech Partners":"icp_and_buying.buying_process.influencer_mapping"}},{title:"KPIs & Pain Points",description:"What this ICP cares about, struggles with, and how success is measured.",fields:{"Target KPIs":"icp_and_buying.kpis_targeted","Pain Points":"icp_and_buying.pain_points","Disqualification Red Flags":"icp_and_buying.red_flags"}},{title:"Buying Committee Breakdown",description:"Key roles involved in the decision-making process.",fields:{"Buyer Personas":"icp_and_buying.buying_committee_personas","Anti-Personas":"icp_and_buying.anti_personas","Influencer Mapping":"icp_and_buying.buying_process.influencer_mapping"}},{title:"Buying Process & Triggers",description:"How and when they buy, and what content or events influence purchase decisions.",fields:{"Buying Stages":"icp_and_buying.buying_process.buying_cycles.key_stages","Average Buying Cycle Length":"icp_and_buying.buying_process.buying_cycles.average_length","Trigger Events":"icp_and_buying.buying_process.trigger_events","Content Sought":"icp_and_buying.buying_process.content_sought"}},{title:"Product & GTM Positioning",description:"What products are offered and how they are positioned for this ICP.",fields:{"Core Product Suite":"icp_and_buying.firmographics.growth_stage","Main Products":"icp_and_buying.firmographics.business_model","Modules & Use Cases":"icp_and_buying.icp_demographics.tech_stack","Target Market":"icp_and_buying.icp_demographics.industry","Unique Selling Points":"icp_and_buying.kpis_targeted","Value Proposition by Segment":"icp_and_buying.icp_demographics.revenue","Market Trends":"icp_and_buying.buying_process.trigger_events","GTM Messaging: CEO":"icp_and_buying.firmographics.decision_making","GTM Messaging: CMO":"icp_and_buying.buying_process.content_sought","GTM Messaging: CTO":"icp_and_buying.icp_demographics.tech_stack"}},{title:"Product Features & Enterprise Readiness",description:"Technical maturity, scalability, and support posture for larger orgs.",fields:{"API Type":"icp_and_buying.icp_demographics.tech_stack",Customization:"icp_and_buying.firmographics.business_model","Developer Tools":"icp_and_buying.buying_process.content_sought",Documentation:"icp_and_buying.kpis_targeted","App Marketplace":"icp_and_buying.icp_demographics.industry",Hosting:"icp_and_buying.icp_demographics.region",Performance:"icp_and_buying.pain_points",Uptime:"icp_and_buying.buying_process.buying_cycles.average_length","Security Certifications":"icp_and_buying.red_flags","Security Features":"icp_and_buying.anti_personas","Support Channels":"icp_and_buying.buying_process.influencer_mapping",SLA:"icp_and_buying.firmographics.sales_channels"}},{title:"Competitive Landscape",description:"Competitor fit and positioning across different market segments.",fields:{"SMB Competitors":"icp_and_buying.icp_demographics.industry","SMB Feature Comparison":"icp_and_buying.firmographics.business_model","Mid-Market Competitors":"icp_and_buying.icp_demographics.tech_stack","Mid-Market Feature Comparison":"icp_and_buying.kpis_targeted","Enterprise Competitors":"icp_and_buying.icp_demographics.size.employees","Enterprise Feature Comparison":"icp_and_buying.firmographics.growth_stage","Threats - SMB":"icp_and_buying.red_flags","Threats - MM":"icp_and_buying.anti_personas","Threats - Enterprise":"icp_and_buying.buying_process.trigger_events","Loss/Win Factors":"icp_and_buying.buying_process.content_sought","Review Plan":"icp_and_buying.buying_process.buying_cycles.key_stages"}},{title:"Case Studies & Proof Points",description:"Client examples and preferred content types for social proof and education.",fields:{"Client Logos + Outcomes":"company_overview.key_contacts","Preferred Content Types":"icp_and_buying.buying_process.content_sought","Objection Handlers":"icp_and_buying.red_flags"}},{title:"ICP Fit Matrix",description:"Scoring criteria to determine fit, neutral, or disqualified targets.",fields:{"ICP Attributes Matrix":"icp_and_buying.firmographics"}}],N=e=>{let{reportData:i}=e;return i?(0,t.jsx)("div",{className:"space-y-6",children:S.map((e,n)=>(0,t.jsxs)(r.Zp,{className:"w-full",children:[(0,t.jsxs)(r.aR,{children:[(0,t.jsx)(r.ZB,{children:e.title}),(0,t.jsx)(r.BT,{children:e.description})]}),(0,t.jsx)(r.Wu,{children:(0,t.jsxs)(f,{children:[(0,t.jsx)(b,{children:(0,t.jsxs)(x,{children:[(0,t.jsx)(w,{className:"w-1/3",children:"Field"}),(0,t.jsx)(w,{children:"Value"})]})}),(0,t.jsx)(v,{children:Object.entries(e.fields).map(e=>{let[n,a]=e,s=function(e,i){if(e&&i)return i.split(".").reduce((e,i)=>e&&void 0!==e[i]?e[i]:void 0,e)}(i,a);return(0,t.jsxs)(x,{children:[(0,t.jsx)(j,{className:"font-medium",children:n}),(0,t.jsx)(j,{className:"whitespace-pre-wrap",children:function(e,i){return null==e?"N/A":Array.isArray(e)?0===e.length?"None":"object"==typeof e[0]?e.map((e,i)=>e.role?"".concat(e.role).concat(e.responsibilities?" (".concat(Array.isArray(e.responsibilities)?e.responsibilities.join(", "):e.responsibilities,")"):""):e.type?"".concat(e.type).concat(e.characteristics?" (".concat(Array.isArray(e.characteristics)?e.characteristics.join(", "):e.characteristics,")"):""):e.name&&e.title?"".concat(e.name," - ").concat(e.title):JSON.stringify(e)).join("; "):e.join(", "):"object"==typeof e?e.external&&e.internal?"External: ".concat(Array.isArray(e.external)?e.external.join(", "):e.external,"; Internal: ").concat(Array.isArray(e.internal)?e.internal.join(", "):e.internal):e.ideal&&e.range?"Ideal: ".concat(e.ideal,", Range: ").concat(e.range):e.growth_stage&&e.business_model?"Growth Stage: ".concat(Array.isArray(e.growth_stage)?e.growth_stage.join(", "):e.growth_stage,", Business Model: ").concat(Array.isArray(e.business_model)?e.business_model.join(", "):e.business_model,", Sales Channels: ").concat(Array.isArray(e.sales_channels)?e.sales_channels.join(", "):e.sales_channels,", Decision Making: ").concat(e.decision_making):JSON.stringify(e):String(e)}(s,0)})]},n)})})]})})]},n))}):(0,t.jsx)("div",{children:"No report data available"})},C=e=>{let{reportData:i}=e;console.log("[CanonicalReportRenderer] Received reportData:",i);let n=function(e){if(!e)return{};if(e.llm_output){let i=e.llm_output;if("string"==typeof i)try{i=JSON.parse(i)}catch(i){return console.error("[CanonicalReportRenderer] Failed to parse llm_output:",i),e}return i}return e.merged?e.merged:e}(i);return console.log("[CanonicalReportRenderer] Extracted canonical data:",n),(0,t.jsx)(N,{reportData:n})};var k=n(4517);let A=e=>{let{reports:i,selectedId:n,onSelect:a}=e;return i.length?(0,t.jsx)("div",{className:"flex flex-wrap gap-2 mb-4",children:i.map(e=>(0,t.jsx)(k.w,{report:e,selected:n===e.id,onClick:()=>a(e)},e.id))}):(0,t.jsx)("p",{className:"text-gray-500 mt-2",children:"No companies analyzed yet. Use Company Analyzer first."})},T=e=>"string"==typeof e?e:Array.isArray(e)?e.map(T).join(", "):"object"==typeof e&&null!==e?JSON.stringify(e):"number"==typeof e||"boolean"==typeof e?String(e):"",R=()=>{let[e,i]=(0,a.useState)(""),{toast:n}=(0,g.dj)(),{setResearch:o}=(0,y.P)(),l=(0,m.useUser)(),f=(0,m.useSession)(),{data:b,loading:v,retry:x}=(0,_.$)(),[w,j]=(0,a.useState)([]),[S,N]=(0,a.useState)(null),[k,T]=(0,a.useState)(null),[R,P]=(0,a.useState)(!1),[M,E]=(0,a.useState)(""),[F,z]=(0,a.useState)([]),[I,B]=(0,a.useState)(!1),[O,D]=(0,a.useState)([]);(0,a.useEffect)(()=>{(null==l?void 0:l.id)&&(0,h.Ez)({userId:l.id}).then(e=>{j(e),e.length>0&&N(e[0].id)})},[null==l?void 0:l.id]),(0,a.useEffect)(()=>{!async function(){if(!k||!S||!(null==l?void 0:l.id))return z([]);let e=k.company_url||k.companyUrl||k.llm_output&&("string"==typeof k.llm_output?JSON.parse(k.llm_output).company_url:k.llm_output.company_url);if(!e)return z([]);B(!0);try{let i=await (0,h.ME)({companyUrl:e,userId:l.id});z(i)}catch(e){z([])}finally{B(!1)}}()},[k,S,null==l?void 0:l.id]);let L=async i=>{if(i&&"function"==typeof i.preventDefault&&i.preventDefault(),console.log("[CompanyAnalyzer] handleSubmit triggered",{url:e,user:l,session:f}),!(null==f?void 0:f.access_token)){n({title:"Auth Error",description:"No access token found. Please log in again.",variant:"destructive"}),console.error("[CompanyAnalyzer] No access token found",{user:l,session:f});return}if(!e.trim())return void n({title:"Error",description:"Please enter a company URL",variant:"destructive"});let t=function(e){let i=e.trim().toLowerCase();return i=(i=(i=i.replace(/^https?:\/\//,"")).replace(/^www\./,"")).replace(/\/$/,""),"https://".concat(i)}(e);T(null),P(!0),E("Company Overview...");let a=[];a.push(setTimeout(()=>E("Market Intelligence..."),4e3)),a.push(setTimeout(()=>E("Tech Stack Analysis..."),13e3)),a.push(setTimeout(()=>E("Sales & GTM Research..."),33e3)),a.push(setTimeout(()=>E("Finalizing Report..."),45e3));try{console.log("=== Starting Company Analysis ==="),console.log("URL:",t),console.log("User ID:",null==l?void 0:l.id),console.log("Session token available:",!!(null==f?void 0:f.access_token));let e=await fetch("/api/company-analyze",{method:"POST",headers:{"Content-Type":"application/json",...(null==f?void 0:f.access_token)?{Authorization:"Bearer ".concat(f.access_token)}:{}},body:JSON.stringify({url:t})});if(!e.ok){let i="LLM failed: ".concat(e.status);try{i=(await e.json()).error||i}catch(e){}throw Error(i)}let i=await e.json(),s=e.ok?null:{message:i.error||"Analysis request failed"};if(console.log("=== Supabase Function Response ==="),console.log("Data:",i),console.log("Error:",s),s)throw console.error("Supabase function error details:",s),Error(s.message||"Analysis request failed");if((null==i?void 0:i.success)&&(null==i?void 0:i.output)){let e=i.output;if(Array.isArray(i.output))if(i.output.length>0)e=i.output[0];else{console.warn("[WARN] data.output is an empty array."),n({title:"Analysis Error",description:"No report returned from analysis.",variant:"destructive"}),P(!1),E(""),a.forEach(clearTimeout);return}let t=e;if(e.llm_output&&(t=e.llm_output,"string"==typeof t))try{t=JSON.parse(t)}catch(e){}T(t),j(i=>[t,...i.filter(i=>i.id!==e.id)]),N(e.id||null),o({companyAnalysis:t,isCached:!1,timestamp:new Date().toISOString()}),x(),n({title:"Analysis Complete",description:"Successfully analyzed ".concat(t.company_name||t.companyName)})}else throw console.error("Analysis failed - no success flag or analysis data"),Error((null==i?void 0:i.error)||"Analysis failed - no data returned")}catch(e){console.error("=== Analysis Error ==="),console.error("Error type:",typeof e),console.error("Error message:",e.message),console.error("Full error:",e),n({title:"Analysis Failed",description:e.message||"Failed to analyze company. Please check the URL and try again.",variant:"destructive"})}finally{P(!1),E(""),a.forEach(clearTimeout)}};return(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)(r.Zp,{children:[(0,t.jsxs)(r.aR,{children:[(0,t.jsxs)(r.ZB,{className:"flex items-center gap-2 text-2xl font-bold",children:[(0,t.jsx)(d,{className:"h-6 w-6 text-primary"}),"Company Analysis"]}),(0,t.jsx)(r.BT,{className:"text-base",children:"Enter a company URL to generate comprehensive business intelligence using our 5-phase research process"})]}),(0,t.jsxs)(r.Wu,{children:[w.length>0&&(0,t.jsx)(A,{reports:w,selectedId:S,onSelect:e=>{N(e.id),T(e)}}),(0,t.jsxs)("form",{onSubmit:L,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{htmlFor:"url",className:"text-sm font-medium",children:"Company URL"}),(0,t.jsx)(c,{id:"url",type:"text",placeholder:"e.g., outbound.ai, notion.so, zapier.com",value:e,onChange:e=>i(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),L(e))},disabled:R,className:"text-base",autoComplete:"off","aria-label":"Company URL"})]}),(0,t.jsx)(s.$,{type:"submit",disabled:R||!e.trim(),className:"w-full",children:R?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.A,{className:"mr-2 h-4 w-4 animate-spin"}),M||"Analyzing..."]}):l?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d,{className:"mr-2 h-4 w-4"}),"Analyze Company"]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u,{className:"mr-2 h-4 w-4"}),"Please log in"]})})]})]})]}),0===w.length?(0,t.jsx)("div",{className:"text-center text-muted-foreground py-8",children:"No company analysis reports found. Run an analysis first."}):(0,t.jsx)("div",{className:"space-y-8",children:k&&S&&"object"==typeof k?(0,t.jsx)(C,{reportData:k}):(0,t.jsx)("div",{className:"text-center text-muted-foreground py-8",children:"Select a report to view details"})})]})};function P(){return(0,t.jsx)(R,{})}}},e=>{var i=i=>e(e.s=i);e.O(0,[753,694,347,870,358],()=>i(6619)),_N_E=e.O()}]);